# BAC4 v1.0.0 - Testing Guide

**Test Vault:** BAC4Testv09
**Location:** `/Users/david.oliver/Documents/Vaults/BAC4Testv09`
**Purpose:** Safe environment for v1.0.0 timeline features development

---

## üß™ Test Environment Setup

### Installation

**Plugin Location:**
```
/Users/david.oliver/Documents/Vaults/BAC4Testv09/.obsidian/plugins/bac4/
```

**Files:**
- `main.js` (568KB) - v0.8.0 current, will update to v1.0.0
- `manifest.json` - v0.8.0 current

### Quick Deploy Command

After making changes, deploy to test vault:
```bash
npm run build && \
cp main.js manifest.json /Users/david.oliver/Documents/Vaults/BAC4Testv09/.obsidian/plugins/bac4/
```

Then reload Obsidian (Cmd+R) to test changes.

---

## üìã Test Files

### Test_Context.bac4

**Location:** `/Users/david.oliver/Documents/Vaults/BAC4Testv09/Test_Context.bac4`

**Purpose:** Basic v1.0.0 format test file with single snapshot

**Contents:**
- Single snapshot ("Current")
- 2 nodes (System + Person)
- 1 edge (User ‚Üí Test System)
- No annotations yet

**Use for testing:**
- File loading (v1.0.0 format)
- Basic canvas rendering
- Node interaction

---

## üéØ Testing Phases

### Phase 1: Data Model & Services (Week 1)

**What to Test:**
1. **File Loading**
   - Open Test_Context.bac4 in Obsidian
   - Verify it loads without errors
   - Check console for any warnings

2. **Timeline Service**
   - Create new snapshot (will be implemented)
   - Switch between snapshots (will be implemented)
   - Delete snapshot (will be implemented)

3. **File Saving**
   - Make a change to node
   - Save file
   - Verify JSON structure is correct

**Test Commands:**
```bash
# Run unit tests
npm test

# Run specific service test
npm test TimelineService

# Watch mode
npm run test:watch
```

**Expected Behavior:**
- v1.0.0 files load successfully
- Timeline structure is present
- Single snapshot renders nodes/edges correctly

---

### Phase 2: Timeline UI (Week 2)

**What to Test:**
1. **Timeline Toolbar Appearance**
   - Open Test_Context.bac4
   - Should NOT show timeline toolbar (only 1 snapshot)
   - Create second snapshot
   - Timeline toolbar should appear

2. **Add Snapshot**
   - Click "+ Add Snapshot" button
   - Modal should open
   - Enter label: "After - Changes"
   - Verify new snapshot created

3. **Navigation**
   - Click Previous/Next buttons
   - Canvas should switch between snapshots
   - Try keyboard shortcuts (Cmd+[, Cmd+])

**Test Scenarios:**
```
Scenario 1: Create Snapshot
1. Open Test_Context.bac4
2. Add new node (System 2)
3. Click "+ Add Snapshot" ‚Üí name "Phase 2"
4. Verify timeline toolbar appears
5. Verify 2 snapshots in dropdown

Scenario 2: Switch Snapshots
1. Continue from Scenario 1
2. Switch to "Current" (should show original 2 nodes)
3. Switch to "Phase 2" (should show 3 nodes)
4. Verify canvas updates correctly

Scenario 3: Delete Snapshot
1. Continue from Scenario 2
2. Open Snapshot Manager (‚öôÔ∏è)
3. Delete "Phase 2"
4. Verify timeline toolbar disappears (back to 1 snapshot)
```

---

### Phase 3: Change Indicators (Week 3)

**What to Test:**
1. **Automatic Detection**
   - Create "Before" snapshot with 2 nodes
   - Create "After" snapshot with 3 nodes (1 new)
   - Switch to "After"
   - New node should have green badge (üü¢)

2. **Manual Override**
   - Select a node
   - Open Property Panel
   - Set "Change Status" to "Modified"
   - Node should show yellow badge (üü°)

3. **Change Notes**
   - Add change note: "Replaced old service"
   - Hover over badge
   - Note should appear in tooltip

**Test File:**
Create `Test_Timeline_Changes.bac4` with:
- Snapshot 1: "Before" (2 nodes)
- Snapshot 2: "After" (3 nodes, 1 new)
- Snapshot 3: "Future" (4 nodes, 1 modified, 1 removed)

---

### Phase 4: Annotation System (Week 4)

**What to Test:**
1. **Annotation Palette**
   - Open Context diagram
   - Annotation palette should appear (top-right)
   - Should show: Text Box, Callout, Badges, Highlight

2. **Drag and Drop**
   - Drag "Text Box" from palette
   - Drop on canvas
   - Should create annotation
   - Should open property editor

3. **Link to Node**
   - Create callout annotation
   - Link to specific node
   - Move node
   - Callout should follow node

4. **Snapshot Visibility**
   - Create annotation in "Before" snapshot
   - Switch to "After" snapshot
   - Annotation should disappear
   - Switch back to "Before"
   - Annotation should reappear

**Test File:**
Create `Test_Annotations.bac4` with:
- Snapshot 1: "Before" (with text annotations)
- Snapshot 2: "After" (with callout annotations)
- Snapshot 3: "Comparison" (with badges and highlights)

---

### Phase 5: Export Enhancements (Week 5)

**What to Test:**
1. **Filename with Snapshot**
   - Open diagram with 2 snapshots
   - Switch to "Before"
   - Export as PNG
   - Filename should be: `Test_Context_Before.png`

2. **Export with Annotations**
   - Create snapshot with annotations
   - Export
   - Verify annotations appear in exported image

3. **Export with Change Indicators**
   - Create snapshot with change badges
   - Export
   - Verify badges appear in exported image

**Expected Files:**
```
Test_Context_Before.png
Test_Context_After.png
Test_Context_Future.png
```

---

### Phase 6: ADR Integration (Week 6)

**What to Test:**
1. **Link to ADR**
   - Create "Before" and "After" snapshots
   - Select node
   - Property Panel ‚Üí "ADR Link"
   - Link to ADR markdown file

2. **Create ADR from Diagram**
   - Right-click node
   - "Create ADR from Diagram"
   - Verify ADR markdown created
   - Verify both exports embedded
   - Verify change summary included

3. **Open ADR**
   - Select node with linked ADR
   - Click "Open ADR" button
   - ADR should open in Obsidian

**Test Files:**
```
ADRs/ADR-001-Test-Architecture.md
  - Should include Test_Context_Before.png
  - Should include Test_Context_After.png
  - Should include change summary
```

---

### Phase 7: Testing & Polish (Week 6)

**What to Test:**
1. **Performance**
   - Create diagram with 10 snapshots
   - Create diagram with 50+ nodes
   - Test snapshot switching speed (<100ms)
   - Test file loading (<1s)

2. **Edge Cases**
   - Delete all snapshots except one
   - Create snapshot with empty canvas
   - Create snapshot with many annotations (20+)
   - Rename snapshot to very long name
   - Create snapshot with special characters in name

3. **Cross-Browser**
   - Test in Obsidian on macOS (primary)
   - If possible, test on Windows/Linux

**Performance Test:**
```bash
# Create large test file
node scripts/create-large-test-file.js

# Should create:
# - 10 snapshots
# - 50 nodes per snapshot
# - 100 edges
# - 30 annotations
```

---

## üêõ Bug Tracking

### Known Issues (to be resolved during development)

**Phase 1:**
- [ ] None yet

**Phase 2:**
- [ ] TBD

**Phase 3:**
- [ ] TBD

**Phase 4:**
- [ ] TBD

**Phase 5:**
- [ ] TBD

**Phase 6:**
- [ ] TBD

**Phase 7:**
- [ ] TBD

---

## ‚úÖ Acceptance Criteria Checklist

### Phase 1 Complete When:
- [ ] Can load v1.0.0 files in Obsidian
- [ ] TimelineService unit tests pass (80%+ coverage)
- [ ] AnnotationService unit tests pass (80%+ coverage)
- [ ] ChangeDetectionService unit tests pass (80%+ coverage)
- [ ] File saving maintains v1.0.0 structure

### Phase 2 Complete When:
- [ ] Timeline toolbar appears with 2+ snapshots
- [ ] Can create new snapshot
- [ ] Can switch between snapshots
- [ ] Can rename snapshots
- [ ] Can delete snapshots
- [ ] Keyboard shortcuts work (Cmd+[, Cmd+])

### Phase 3 Complete When:
- [ ] New nodes show green badge
- [ ] Modified nodes show yellow badge (when manually set)
- [ ] Removed nodes show red badge
- [ ] Change notes appear in tooltip
- [ ] Manual override works

### Phase 4 Complete When:
- [ ] Annotation palette appears for Context/Container
- [ ] Can drag-and-drop annotations
- [ ] Annotations link to nodes
- [ ] Annotations show/hide with snapshot
- [ ] Annotations included in exports

### Phase 5 Complete When:
- [ ] Export filename includes snapshot label
- [ ] Can select snapshot to export
- [ ] Annotations included in export
- [ ] Change indicators included in export
- [ ] All formats work (PNG, JPEG, SVG)

### Phase 6 Complete When:
- [ ] Can link node to ADR
- [ ] Can create ADR from diagram
- [ ] ADR includes both exports
- [ ] Change summary generated
- [ ] Open ADR button works

### Phase 7 Complete When:
- [ ] All above acceptance criteria met
- [ ] No critical bugs
- [ ] Performance targets met
- [ ] Documentation complete

---

## üìä Testing Metrics

### Performance Targets

| Operation | Target | How to Measure |
|-----------|--------|----------------|
| Snapshot switching | <100ms | Console.time() in TimelineService |
| File loading (10 snapshots) | <1s | Obsidian profiler |
| Export with annotations | <3s | Console.time() in export flow |

### Quality Targets

| Metric | Target | How to Measure |
|--------|--------|----------------|
| Unit test coverage | 80%+ | `npm run test:coverage` |
| Critical bugs | 0 | Manual testing + GitHub issues |
| Minor bugs | <5 | Manual testing + GitHub issues |

---

## üîÑ Continuous Testing Workflow

### During Development

**After Each Commit:**
```bash
# 1. Run tests
npm test

# 2. Build
npm run build

# 3. Deploy to test vault
cp main.js manifest.json /Users/david.oliver/Documents/Vaults/BAC4Testv09/.obsidian/plugins/bac4/

# 4. Reload Obsidian (Cmd+R)

# 5. Manual test changed feature
```

### Daily Testing

**Start of Day:**
- [ ] Open test vault
- [ ] Verify plugin loads
- [ ] Run through current phase checklist

**End of Day:**
- [ ] Commit changes
- [ ] Update phase checklist
- [ ] Document any bugs found

### Weekly Testing

**End of Week:**
- [ ] Run full test suite
- [ ] Test all completed phases
- [ ] Update TODO list
- [ ] Review progress vs. timeline

---

## üìù Test Log Template

**Date:** YYYY-MM-DD
**Phase:** X
**Tester:** David Oliver

**What Was Tested:**
- Feature/component tested
- Test scenarios executed

**Results:**
- ‚úÖ Passed: [list]
- ‚ùå Failed: [list]
- ‚ö†Ô∏è Issues: [list]

**Next Steps:**
- Action items
- Bugs to fix
- Features to implement

---

## üéØ Ready for Testing

**Current Status:** ‚úÖ Test environment ready

**Next Steps:**
1. Start Phase 1 implementation
2. Deploy to test vault after each major change
3. Use Test_Context.bac4 as starting point
4. Create additional test files as needed

**Test Vault:** BAC4Testv09
**Plugin Version:** v0.8.0 (will update to v1.0.0 during development)
**Test File:** Test_Context.bac4 (v1.0.0 format)

---

**Last Updated:** 2025-10-15
**Status:** Ready for Phase 1 development
**Next:** Begin implementing TypeScript interfaces
